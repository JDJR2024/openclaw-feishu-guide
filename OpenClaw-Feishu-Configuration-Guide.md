# OpenClaw é£ä¹¦æ¥å…¥å®Œæ•´é…ç½®æŒ‡å—

> åŸºäºå®é™…æˆåŠŸé…ç½®ç»éªŒæ€»ç»“ï¼Œé¿å…å¸¸è§é…ç½®é™·é˜±

## ğŸ“‹ ç›®å½•
- [æ¦‚è¿°](#æ¦‚è¿°)
- [å‰ç½®æ¡ä»¶](#å‰ç½®æ¡ä»¶)
- [é…ç½®æ­¥éª¤](#é…ç½®æ­¥éª¤)
  - [1. é£ä¹¦å¼€æ”¾å¹³å°é…ç½®](#1-é£ä¹¦å¼€æ”¾å¹³å°é…ç½®)
  - [2. OpenClawæ’ä»¶å®‰è£…](#2-openclawæ’ä»¶å®‰è£…)
  - [3. OpenClawé…ç½®](#3-openclawé…ç½®)
  - [4. æµ‹è¯•ä¸éªŒè¯](#4-æµ‹è¯•ä¸éªŒè¯)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [é…ç½®ç¤ºä¾‹](#é…ç½®ç¤ºä¾‹)
- [é«˜çº§åŠŸèƒ½](#é«˜çº§åŠŸèƒ½)

## æ¦‚è¿°

OpenClaw é€šè¿‡ `@m1heng-clawd/feishu` æ’ä»¶æ”¯æŒé£ä¹¦/Larké›†æˆã€‚æ’ä»¶ä½¿ç”¨ **WebSocketé•¿è¿æ¥** æ–¹å¼ï¼Œ**ä¸éœ€è¦é…ç½®Webhookå›è°ƒURL**ï¼Œç®€åŒ–äº†éƒ¨ç½²æµç¨‹ã€‚

## å‰ç½®æ¡ä»¶

- å·²å®‰è£… OpenClaw
- é£ä¹¦ä¼ä¸šè´¦å·ï¼ˆç”¨äºåˆ›å»ºè‡ªå»ºåº”ç”¨ï¼‰
- åŸºæœ¬çš„å‘½ä»¤è¡Œæ“ä½œçŸ¥è¯†

## é…ç½®æ­¥éª¤

### 1. é£ä¹¦å¼€æ”¾å¹³å°é…ç½®

#### 1.1 åˆ›å»ºåº”ç”¨
1. è®¿é—® [é£ä¹¦å¼€æ”¾å¹³å°](https://open.feishu.cn)
2. ç™»å½•ååˆ›å»º"ä¼ä¸šè‡ªå»ºåº”ç”¨"
3. è®°å½•åº”ç”¨å‡­è¯ï¼š
   - **App ID**: `cli_xxxxxxxxxx`
   - **App Secret**: `xxxxxxxxxx`

#### 1.2 é…ç½®æƒé™ï¼ˆå…³é”®ï¼ï¼‰
åœ¨"æƒé™ç®¡ç†"é¡µé¢æ·»åŠ ä»¥ä¸‹**å¿…éœ€æƒé™**ï¼š

| æƒé™ | è¯´æ˜ |
|------|------|
| `contact:user.base:readonly` | è¯»å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ |
| `im:message` | æ¶ˆæ¯æ”¶å‘æƒé™ |
| `im:message.p2p_msg:readonly` | è¯»å–ç§èŠæ¶ˆæ¯ |
| `im:message.group_at_msg:readonly` | è¯»å–ç¾¤èŠ@æ¶ˆæ¯ |
| `im:message:send_as_bot` | ä»¥æœºå™¨äººèº«ä»½å‘é€æ¶ˆæ¯ |
| `im:resource` | åª’ä½“æ–‡ä»¶ä¸Šä¼ ä¸‹è½½ |

#### 1.3 é…ç½®äº‹ä»¶è®¢é˜…ï¼ˆæœ€é‡è¦ï¼ï¼‰
åœ¨"äº‹ä»¶è®¢é˜…"é¡µé¢ï¼š

1. **äº‹ä»¶é…ç½®æ–¹å¼**ï¼šé€‰æ‹© **"ä½¿ç”¨é•¿è¿æ¥æ¥æ”¶äº‹ä»¶"** âš ï¸
   - **ä¸è¦é€‰æ‹©Webhook**
   - **ä¸éœ€è¦å¡«å†™å›è°ƒURL**

2. **æ·»åŠ äº‹ä»¶**ï¼š
   - `im.message.receive_v1`ï¼ˆæ¥æ”¶æ¶ˆæ¯ï¼Œå¿…éœ€ï¼‰

3. **ä¿å­˜é…ç½®**

#### 1.4 å‘å¸ƒç‰ˆæœ¬
1. è¿›å…¥"ç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒ"
2. åˆ›å»ºæ–°ç‰ˆæœ¬ï¼ŒåŒ…å«æ‰€æœ‰æ·»åŠ çš„æƒé™
3. æäº¤å®¡æ ¸å¹¶å‘å¸ƒï¼ˆä¼ä¸šè‡ªå»ºåº”ç”¨é€šå¸¸è‡ªåŠ¨é€šè¿‡ï¼‰

### 2. OpenClawæ’ä»¶å®‰è£…

```bash
# å®‰è£…é£ä¹¦æ’ä»¶
openclaw plugins install @m1heng-clawd/feishu

# éªŒè¯å®‰è£…
openclaw plugins list | grep feishu
```

### 3. OpenClawé…ç½®

ç¼–è¾‘ `~/.openclaw/openclaw.json`ï¼Œåœ¨ `channels` éƒ¨åˆ†æ·»åŠ ï¼š

```json
"feishu": {
  "enabled": true,
  "appId": "ä½ çš„App ID",
  "appSecret": "ä½ çš„App Secret",
  "domain": "feishu",           // å›½å†…ç”¨"feishu"ï¼Œå›½é™…ç‰ˆç”¨"lark"
  "connectionMode": "websocket", // å¿…é¡»ä¸ºwebsocket
  "dmPolicy": "pairing",        // ç§èŠç­–ç•¥ï¼špairing|open|allowlist
  "groupPolicy": "allowlist",   // ç¾¤èŠç­–ç•¥ï¼šopen|allowlist|disabled
  "requireMention": true,       // ç¾¤èŠæ˜¯å¦éœ€è¦@æåŠ
  "mediaMaxMb": 30,             // åª’ä½“æ–‡ä»¶æœ€å¤§å¤§å°(MB)
  "renderMode": "auto"          // æ¸²æŸ“æ¨¡å¼ï¼šauto|raw|card
}
```

### 4. æµ‹è¯•ä¸éªŒè¯

#### 4.1 é‡å¯OpenClaw
```bash
openclaw gateway restart
```

#### 4.2 åœ¨é£ä¹¦ä¸­æµ‹è¯•
1. åœ¨é£ä¹¦æœç´¢ä½ çš„æœºå™¨äºº
2. å‘é€æ¶ˆæ¯ï¼š`@æœºå™¨äºº ä½ å¥½`
3. åº”è¯¥æ”¶åˆ°å›å¤

#### 4.3 éªŒè¯è¿æ¥
```bash
# æ£€æŸ¥æ’ä»¶çŠ¶æ€
openclaw plugins info feishu

# æŸ¥çœ‹æ—¥å¿—
tail -f /tmp/openclaw/openclaw-*.log
```

## å¸¸è§é—®é¢˜

### Q1: æœºå™¨äººèƒ½å‘æ¶ˆæ¯ä½†æ”¶ä¸åˆ°æ¶ˆæ¯
**åŸå› **ï¼šäº‹ä»¶è®¢é˜…é…ç½®é”™è¯¯
**è§£å†³**ï¼š
1. ç¡®è®¤é€‰æ‹©äº†"ä½¿ç”¨é•¿è¿æ¥æ¥æ”¶äº‹ä»¶"
2. ç¡®è®¤æ·»åŠ äº† `im.message.receive_v1` äº‹ä»¶
3. ç¡®è®¤æƒé™å·²å‘å¸ƒç”Ÿæ•ˆ

### Q2: è¿”å› 99991672 æƒé™é”™è¯¯
**åŸå› **ï¼šç¼ºå°‘ `contact:user.employee_id:readonly` æƒé™
**è§£å†³**ï¼šåœ¨é£ä¹¦å¹³å°æ·»åŠ è¯¥æƒé™å¹¶é‡æ–°å‘å¸ƒ

### Q3: æ˜¯å¦éœ€è¦é…ç½®å›è°ƒURLï¼Ÿ
**ç­”æ¡ˆ**ï¼š**ä¸éœ€è¦**ï¼æ’ä»¶ä½¿ç”¨WebSocketé•¿è¿æ¥ï¼Œä¸éœ€è¦Webhooké…ç½®ã€‚

### Q4: æ˜¯å¦éœ€è¦å†…ç½‘ç©¿é€ï¼ˆngrokï¼‰ï¼Ÿ
**ç­”æ¡ˆ**ï¼š**ä¸éœ€è¦**ï¼WebSocketæ˜¯å®¢æˆ·ç«¯ä¸»åŠ¨è¿æ¥ï¼Œä¸éœ€è¦å…¬ç½‘å¯è®¿é—®çš„æœåŠ¡å™¨ã€‚

## é…ç½®ç¤ºä¾‹

### å®Œæ•´é…ç½®ç¤ºä¾‹
```json
{
  "channels": {
    "feishu": {
      "enabled": true,
      "appId": "cli_a9f74071adb89bdb",
      "appSecret": "PQWM9WoA7sarVi6m3j5k1dQ6vUtVv0G8",
      "domain": "feishu",
      "connectionMode": "websocket",
      "dmPolicy": "pairing",
      "groupPolicy": "allowlist",
      "requireMention": true,
      "mediaMaxMb": 30,
      "renderMode": "auto"
    }
  }
}
```

### æœ€å°åŒ–é…ç½®
```json
{
  "channels": {
    "feishu": {
      "enabled": true,
      "appId": "ä½ çš„App ID",
      "appSecret": "ä½ çš„App Secret",
      "connectionMode": "websocket"
    }
  }
}
```

## é«˜çº§åŠŸèƒ½

### æ–‡æ¡£å·¥å…·
é£ä¹¦æ’ä»¶æä¾›å®Œæ•´çš„æ–‡æ¡£æ“ä½œå·¥å…·ï¼š
- `feishu_doc_read` - è¯»å–æ–‡æ¡£
- `feishu_doc_create` - åˆ›å»ºæ–‡æ¡£
- `feishu_doc_write` - å†™å…¥æ–‡æ¡£
- `feishu_doc_append` - è¿½åŠ å†…å®¹
- `feishu_folder_list` - åˆ—å‡ºæ–‡ä»¶å¤¹

### ä½¿ç”¨ç¤ºä¾‹
```bash
# æŸ¥çœ‹æ‰€æœ‰é£ä¹¦å·¥å…·
openclaw plugins info feishu

# è¯»å–æ–‡æ¡£
# éœ€è¦é¢å¤–æƒé™ï¼šdocx:document:readonly
```

### ç¾¤èŠé…ç½®
- `requireMention: true` - ç¾¤èŠä¸­éœ€è¦@æœºå™¨äººæ‰èƒ½è§¦å‘å›å¤
- `groupPolicy: "allowlist"` - åªå…è®¸ç‰¹å®šç¾¤èŠ
- `dmPolicy: "pairing"` - ç§èŠéœ€è¦å…ˆé…å¯¹

## æœ€ä½³å®è·µ

1. **å…ˆæµ‹è¯•åŸºæœ¬åŠŸèƒ½**ï¼šç¡®ä¿æ¶ˆæ¯æ”¶å‘æ­£å¸¸åå†é…ç½®é«˜çº§åŠŸèƒ½
2. **æƒé™æœ€å°åŒ–**ï¼šåªæ·»åŠ å¿…è¦çš„æƒé™
3. **ä½¿ç”¨é•¿è¿æ¥**ï¼šé¿å…Webhookçš„å¤æ‚æ€§
4. **åŠæ—¶æŸ¥çœ‹æ—¥å¿—**ï¼šé‡åˆ°é—®é¢˜æ—¶é¦–å…ˆæ£€æŸ¥æ—¥å¿—
5. **åˆ†æ­¥éªŒè¯**ï¼šæ¯å®Œæˆä¸€æ­¥éƒ½è¿›è¡ŒéªŒè¯

## æ•…éšœæ’é™¤

### æŸ¥çœ‹è¿æ¥çŠ¶æ€
```bash
# æŸ¥çœ‹é£ä¹¦æ’ä»¶æ—¥å¿—
grep -i feishu /tmp/openclaw/openclaw-*.log

# æ£€æŸ¥WebSocketè¿æ¥
netstat -an | grep 18789
```

### é‡æ–°å®‰è£…æ’ä»¶
```bash
# å¸è½½æ’ä»¶
openclaw plugins remove feishu

# é‡æ–°å®‰è£…
openclaw plugins install @m1heng-clawd/feishu
```

### é‡ç½®é…ç½®
```bash
# å¤‡ä»½åŸé…ç½®
cp ~/.openclaw/openclaw.json ~/.openclaw/openclaw.json.backup

# ä½¿ç”¨æœ€å°é…ç½®æµ‹è¯•
```

## æ€»ç»“

OpenClawé£ä¹¦æ¥å…¥çš„å…³é”®ç‚¹ï¼š
1. **ä½¿ç”¨WebSocketé•¿è¿æ¥**ï¼Œä¸éœ€è¦Webhook
2. **æ­£ç¡®é…ç½®6ä¸ªå¿…éœ€æƒé™**
3. **äº‹ä»¶è®¢é˜…é€‰æ‹©"é•¿è¿æ¥"æ–¹å¼**
4. **åŠæ—¶å‘å¸ƒæ–°ç‰ˆæœ¬ä½¿æƒé™ç”Ÿæ•ˆ**

æŒ‰ç…§æœ¬æŒ‡å—é…ç½®ï¼Œé€šå¸¸å¯ä»¥åœ¨10åˆ†é’Ÿå†…å®Œæˆé£ä¹¦æ¥å…¥ã€‚

---

*æœ€åæ›´æ–°ï¼š2026å¹´1æœˆ31æ—¥*  
*åŸºäº OpenClaw 2026.1.29 å’Œ @m1heng-clawd/feishu 0.1.4 æµ‹è¯•*